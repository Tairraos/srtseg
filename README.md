# SRTåˆ†è¯å·¥å…· (srtseg)

ä¸€ä¸ªåŸºäºNode.jsçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå°†SRTå­—å¹•æ–‡ä»¶ä»å¥å­çº§åˆ«æ‹†åˆ†ä¸ºè¯è¯­çº§åˆ«ï¼Œæé«˜å­—å¹•çš„ç²¾ç»†åŒ–æ˜¾ç¤ºæ•ˆæœã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”¤ **ä¸­æ–‡åˆ†è¯**: ä½¿ç”¨NodeJiebaè¿›è¡Œç²¾å‡†çš„ä¸­æ–‡åˆ†è¯å¤„ç†
- â±ï¸ **æ™ºèƒ½æ—¶é—´åˆ†é…**: æ ¹æ®è¯è¯­å­—æ•°æ¯”ä¾‹åˆ†é…æ—¶é—´ï¼Œç¡®ä¿æ€»æ—¶é•¿ä¸€è‡´
- ğŸ“ **æ‰¹é‡å¤„ç†**: æ”¯æŒå¤„ç†åŒ…å«å¤šä¸ªå­—å¹•æ¡ç›®çš„SRTæ–‡ä»¶
- ğŸ¯ **ç²¾ç¡®æ§åˆ¶**: å¯è®¾ç½®æœ€å°/æœ€å¤§è¯è¯­æ˜¾ç¤ºæ—¶é—´
- ğŸ“Š **ç»Ÿè®¡ä¿¡æ¯**: æä¾›è¯¦ç»†çš„å¤„ç†ç»Ÿè®¡å’Œæ–‡ä»¶åˆ†æ
- ğŸ› ï¸ **æ˜“äºä½¿ç”¨**: ç®€æ´çš„å‘½ä»¤è¡Œç•Œé¢ï¼Œæ”¯æŒå¤šç§å‚æ•°é…ç½®

## å®‰è£…

### å…¨å±€å®‰è£…

```bash
npm install -g srtseg
```

### æœ¬åœ°å®‰è£…

```bash
npm install srtseg
```

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# å¤„ç†SRTæ–‡ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆè¾“å‡ºæ–‡ä»¶
srtseg input.srt

# æŒ‡å®šè¾“å‡ºæ–‡ä»¶
srtseg input.srt output.srt

# ä½¿ç”¨-oå‚æ•°æŒ‡å®šè¾“å‡ºæ–‡ä»¶
srtseg -i input.srt -o output.srt
```

### é«˜çº§é€‰é¡¹

```bash
# è®¾ç½®æœ€å°å’Œæœ€å¤§è¯è¯­æ˜¾ç¤ºæ—¶é—´
srtseg input.srt --min-duration 300 --max-duration 2000

# æ˜¾ç¤ºè¯¦ç»†å¤„ç†ä¿¡æ¯
srtseg input.srt --verbose

# æ˜¾ç¤ºæ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯
srtseg input.srt --stats
```

### å…¶ä»–å‘½ä»¤

```bash
# éªŒè¯SRTæ–‡ä»¶æ ¼å¼
srtseg validate input.srt

# æ˜¾ç¤ºæ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯
srtseg stats input.srt

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
srtseg --help

# æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
srtseg --version
```

## å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | æè¿° | é»˜è®¤å€¼ |
|------|------|--------|
| `<input>` | è¾“å…¥çš„SRTæ–‡ä»¶è·¯å¾„ | å¿…éœ€ |
| `[output]` | è¾“å‡ºçš„SRTæ–‡ä»¶è·¯å¾„ | `{è¾“å…¥æ–‡ä»¶å}_segmented.srt` |
| `-o, --output <file>` | æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„ | - |
| `--min-duration <ms>` | æœ€å°è¯è¯­æ˜¾ç¤ºæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ | 200 |
| `--max-duration <ms>` | æœ€å¤§è¯è¯­æ˜¾ç¤ºæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ | 3000 |
| `--verbose` | æ˜¾ç¤ºè¯¦ç»†å¤„ç†ä¿¡æ¯ | false |
| `--stats` | æ˜¾ç¤ºæ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯ | false |
| `-h, --help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | - |
| `-v, --version` | æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ | - |

## å¤„ç†ç¤ºä¾‹

### è¾“å…¥æ–‡ä»¶ (input.srt)

```
1
00:00:01,000 --> 00:00:04,000
ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œæˆ‘ä»¬å»å…¬å›­æ•£æ­¥å§ã€‚

2
00:00:05,000 --> 00:00:08,000
å¥½çš„ï¼Œæˆ‘ä»¬ä¸€èµ·å»çœ‹çœ‹èŠ±å¼€äº†æ²¡æœ‰ã€‚
```

### è¾“å‡ºæ–‡ä»¶ (input_segmented.srt)

```
1
00:00:01,000 --> 00:00:01,400
ä»Šå¤©

2
00:00:01,400 --> 00:00:01,800
å¤©æ°”

3
00:00:01,800 --> 00:00:02,000
çœŸ

4
00:00:02,000 --> 00:00:02,400
ä¸é”™

5
00:00:02,400 --> 00:00:02,600
ï¼Œ

6
00:00:02,600 --> 00:00:03,000
æˆ‘ä»¬

7
00:00:03,000 --> 00:00:03,200
å»

8
00:00:03,200 --> 00:00:03,600
å…¬å›­

9
00:00:03,600 --> 00:00:04,000
æ•£æ­¥

10
00:00:04,000 --> 00:00:04,000
å§
```

## ç¼–ç¨‹æ¥å£

é™¤äº†å‘½ä»¤è¡Œå·¥å…·ï¼Œsrtsegä¹Ÿæä¾›äº†ç¼–ç¨‹æ¥å£ï¼š

```typescript
import { processSRTFile, SRTProcessor } from 'srtseg';

// ä½¿ç”¨ä¾¿æ·å‡½æ•°
const result = await processSRTFile({
  inputFile: 'input.srt',
  outputFile: 'output.srt',
  minWordDuration: 200,
  maxWordDuration: 3000,
  verbose: true,
});

// ä½¿ç”¨å¤„ç†å™¨ç±»
const processor = new SRTProcessor({
  inputFile: 'input.srt',
  outputFile: 'output.srt',
});

const result = await processor.process();
console.log(result);
```

## æŠ€æœ¯æ¶æ„

- **Node.js**: è¿è¡Œç¯å¢ƒ
- **TypeScript**: å¼€å‘è¯­è¨€
- **NodeJieba**: ä¸­æ–‡åˆ†è¯å¼•æ“
- **Commander.js**: å‘½ä»¤è¡Œå‚æ•°è§£æ
- **ESLint + Prettier**: ä»£ç è§„èŒƒ
- **Jest**: å•å…ƒæµ‹è¯•

## ç®—æ³•åŸç†

1. **SRTè§£æ**: è¯»å–SRTæ–‡ä»¶ï¼Œæå–å­—å¹•åºå·ã€æ—¶é—´æˆ³å’Œæ–‡æœ¬å†…å®¹
2. **ä¸­æ–‡åˆ†è¯**: ä½¿ç”¨NodeJiebaå¯¹æ¯å¥å­—å¹•æ–‡æœ¬è¿›è¡Œåˆ†è¯
3. **æ—¶é—´åˆ†é…**: æ ¹æ®è¯è¯­å­—æ•°æ¯”ä¾‹ä»åŸå¥æ€»æ—¶é•¿ä¸­åˆ†é…æ—¶é—´
4. **æ—¶é—´ä¼˜åŒ–**: å¯¹åˆ†é…ç»“æœè¿›è¡Œå¾®è°ƒï¼Œç¡®ä¿æ—¶é—´åˆ†é…åˆç†
5. **SRTç”Ÿæˆ**: å°†åˆ†è¯åçš„è¯è¯­æŒ‰æ–°çš„æ—¶é—´åˆ†é…ç”ŸæˆSRTæ–‡ä»¶

## å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- pnpm (æ¨è) æˆ– npm

### å¼€å‘å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¼€å‘æ¨¡å¼è¿è¡Œ
pnpm dev input.srt

# æ„å»ºé¡¹ç›®
pnpm build

# è¿è¡Œæµ‹è¯•
pnpm test

# ä»£ç æ£€æŸ¥
pnpm lint

# ä»£ç æ ¼å¼åŒ–
pnpm format
```

### å‘å¸ƒ

```bash
# æ›´æ–°ç‰ˆæœ¬
pnpm version:patch  # è¡¥ä¸ç‰ˆæœ¬
pnpm version:minor  # æ¬¡è¦ç‰ˆæœ¬
pnpm version:major  # ä¸»è¦ç‰ˆæœ¬

# å‘å¸ƒåˆ°npm
pnpm publish:npm
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## æ›´æ–°æ—¥å¿—

### v1.0.0

- ğŸ‰ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ¨ æ”¯æŒä¸­æ–‡åˆ†è¯å¤„ç†
- âœ¨ æ™ºèƒ½æ—¶é—´åˆ†é…ç®—æ³•
- âœ¨ å‘½ä»¤è¡Œå·¥å…·
- âœ¨ ç¼–ç¨‹æ¥å£
- âœ¨ å®Œæ•´çš„æ–‡æ¡£å’Œç¤ºä¾‹